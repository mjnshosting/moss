#Installation instructions:
#Run the following commands as root or do that sudo crap. 

#After initial install run some updates
apt-get update && apt-get upgrade
apt-get install rpi-update
rpi-update 

#Reboot before moving on

#Install some programs
apt-get install apache2 mysql-server openssh-server php5 php5-mysql php5-memcache php5-curl php-apc php-soap php5-imap memcached php5-gd php-pear php5-mcrypt phpmyadmin php-net-imap php-net-ldap mysql-server nmap whois libapache2-mod-php5 php5-cli php5-json snmp fping mysql-client python-mysqldb rrdtool subversion mtr-tiny ipmitool graphviz imagemagick snmpd cacti cacti-spine openssl shellinabox libapache2-mod-proxy-html stress sqlite3 php5-sqlite  wakeonlan libapache2-mod-proxy-html libxml2-dev apcupsd rsync

#Link some apache mods
ln -s /etc/apache2/mods-available/proxy.load /etc/apache2/mods-enabled
ln -s /etc/apache2/mods-available/proxy_http.load /etc/apache2/mods-enabled

#Overwrite default conf files:
cp ./confs/shellinabox /etc/default/shellinabox
cp ./confs/apache-000-default /etc/apache2/sites-available/000-default.conf
cp ./cacti/mjnspi-mon-logo.png /usr/share/cacti/site/images/
cp ./cacti/auth_login.php /usr/share/cacti/site/auth_login.php
cp ./cacti/csrf-magic.php /usr/share/cacti/site/include/csrf/csrf-magic.php

#Copy interface to html folder and change permissions
cp ./interface/* /var/www/html/
chmod -R 755 /var/www/html/*
chown -R www-data:www-data /var/www/html

#USB Drive Creation:
mkfs.ext4 -L moss-usb /dev/sda1
echo "/dev/sda1       /mnt/moss-usb   ext4    defaults          0       1" >> /etc/fstab
mkdir /mnt/moss-usb
mount -a
